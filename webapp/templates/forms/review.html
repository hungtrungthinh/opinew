{% import "_macros.html" as macros %}
{% if order %}
    <span class="label label-success">
                  <span class="glyphicon glyphicon-ok"></span> Verified purchase
              </span>
{% endif %}
{% if shop_product and shop_product.shop.owner == current_user %}
    <span class="label label-info">
                  <span class="glyphicon glyphicon-user"></span> By shop owner
              </span>
{% endif %}
<br>
<form class="action" method="post" action="{{ url_for('media.upload_review_photo') }}">
    <img src="" class="img-thumbnail img-responsive" style="max-height:200px; max-width:500px; margin: 20px 0 20px 0;"
         hidden id="review-photo-img"/>
    <br>
  {{ review_photo_form.hidden_tag() }}
  {{ review_photo_form.photo(class="form-control") }}<br>
</form>
<form class="action" method="post" action="{{ g.constants.API_V1_URL_PREFIX }}/review" id="review-form">
    <input type="hidden" name="next" value="{{ request.args.next }}"/>
  {{ review_form.hidden_tag() }}
  {% if order %}
      <input type="hidden" class="form-serialize" name="order_id" value="{{ order.id }}">
      <input type="hidden" class="form-serialize" name="order_token" value="{{ order.token }}">
  {% endif %}
  {% if shop_product %}
      <input type="hidden" class="form-serialize" name="shop_product_id" value="{{ shop_product.id }}">
  {% else %}
      <div class="form-group">
          <label for="sel_product">Select product</label>
          <select class="form-control form-serialize" name="shop_product_id" id="sel_product">
            {% for shop_product in shop_products %}
                <option value="{{ shop_product.id }}">{{ shop_product.product.name }}</option>
            {% endfor %}
          </select>
      </div>
  {% endif %}
    <fieldset class="rating">
        <input type="radio" id="star5" name="star_rating" value="5" class="form-serialize"/>
        <label for="star5" title="Rocks!">5 stars</label>
        <input type="radio" id="star4" name="star_rating" value="4" class="form-serialize"/>
        <label for="star4" title="Pretty good">4 stars</label>
        <input type="radio" id="star3" name="star_rating" value="3" class="form-serialize"/>
        <label for="star3" title="Meh">3 stars</label>
        <input type="radio" id="star2" name="star_rating" value="2" class="form-serialize"/>
        <label for="star2" title="Kinda bad">2 stars</label>
        <input type="radio" id="star1" name="star_rating" value="1" class="form-serialize"/>
        <label for="star1" title="Sucks big time">1 star</label>
    </fieldset>
  {{ macros.form_field(review_form, review_form.body, class="form-control form-serialize", placeholder='Write your review...') }}<br>
  {{ review_form.photo_url(class="form-control form-serialize hidden") }}<br>
  {{ review_form.submit(class="btn-primary form-control") }}<br>
</form>

<style>
    .rating {
        float: left;
    }

    /* :not(:checked) is a filter, so that browsers that don’t support :checked don’t
       follow these rules. Every browser that supports :checked also supports :not(), so
       it doesn’t make the test unnecessarily selective */
    .rating:not(:checked) > input {
        position: absolute;
        top: -9999px;
        clip: rect(0, 0, 0, 0);
    }

    .rating:not(:checked) > label {
        float: right;
        width: 1em;
        padding: 0 .1em;
        overflow: hidden;
        white-space: nowrap;
        cursor: pointer;
        font-size: 200%;
        line-height: 1.2;
        color: #666;
    }

    .rating:not(:checked) > label:before {
        content: '★ ';
    }

    .rating > input:checked ~ label {
        color: #fb8c2d;
    }

    .rating:not(:checked) > label:hover,
    .rating:not(:checked) > label:hover ~ label {
        color: #FF8E2E;
    }

    .rating > input:checked + label:hover,
    .rating > input:checked + label:hover ~ label,
    .rating > input:checked ~ label:hover,
    .rating > input:checked ~ label:hover ~ label,
    .rating > label:hover ~ input:checked ~ label {
        color: #FFB77A;
    }

    .rating > label:active {
        position: relative;
        top: 2px;
        left: 2px;
    }
</style>